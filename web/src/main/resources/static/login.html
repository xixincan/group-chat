<!DOCTYPE html>
<html>
<head>
    <title>ROOT聊天室</title>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link rel="icon" href="img/chat.ico" type="image/x-icon"/>
    <script type="application/x-javascript">
        addEventListener("load", function () {
            setTimeout(hideURLbar, 0);
        }, false);

        function hideURLbar() {
            window.scrollTo(0, 1);
        }
    </script>
    <link rel="stylesheet" type="text/css" media="all" href="css/style.css"/>
    <script type="text/javascript" src="js/common/jquery-1.9.1.min.js"></script>
</head>
<body>
<div class="main">
    <h1>ROOT聊天室</h1>
    <div class="w3_login">
        <div class="w3_login_module">
            <div class="module form-module">
                <div class="toggle">
                    <i class="fa-times">注册</i>
                    <div class="tooltip">没有账号？</div>
                </div>
                <div class="form">
                    <h2>登录账号</h2>
                    <form onsubmit="login();return false;">
                        <input type="text" id="username" name="username" placeholder="用户名" required="required"/>
                        <input type="password" id="password" name="password" placeholder="密码" required="required"/>
                        <input type="submit" value="登录"/>
                    </form>
                </div>
                <div class="form">
                    <h2>创建一个账号</h2>
                    <form onsubmit="register();return false;">
                        <input type="text" name="username" placeholder="用户名" required="required"/>
                        <input type="password" name="Password" placeholder="密码" required="required"/>
                        <input type="email" name="Email" placeholder="Email" required="required"/>
                        <input type="text" name="Phone" placeholder="电话" required="required"/>
                        <input id="dologin" type="submit" value="注册"/>
                    </form>
                </div>
                <div class="cta"><a href="#">忘记密码?</a></div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript" src="js/backgroud.js"></script>
<script type="text/javascript" src="js/encrypt/encrypt.js"></script>
<script type="text/javascript">
    var a = "登录";
    var b = "注册";
    var tip = a;
    $('.toggle').click(function () {
        $(".tooltip").hide();
        $(this).children('i').text(tip);
        var c = a;
        a = b;
        b = c;
        tip = a;
        $('.form').animate({
            height: "toggle",
            'padding-top': 'toggle',
            'padding-bottom': 'toggle',
            opacity: "toggle"
        }, "slow");
    });

    function login() {
        $.ajax({
            type: 'POST',
            url: 'login',
            // dataType: 'json',
            // contentType: 'application/json',
            data: {
                username: $("#username").val(),
                password: encrypt($("#password").val())
            },
            async: false,
            success: function (data) {
                if (data.code === 200) {
                    window.location.href = "/";
                } else if (data.code === 500) {
                    window.location.href = "error/500.html"
                } else {
                    alert(data.message);
                }
            }
        });
    }

    function register() {
        alert("删库跑路了，暂时注册不了，敬请期待！");
    }

    // 绑定发送按钮回车事件
    $('#dologin').keydown(function (e) {
        // console.log(e.keyCode);
        if (e.keyCode === 13) {
            $('#dologin').trigger('click');
            e.preventDefault(); //屏蔽enter对系统作用。按后增加\r\n等换行
        }
    });

    initPoints(99);
    drawFrame();
</script>
<div style="text-align:center;">
    <p style="color:#ffffff">&copy; 2020 ROOT Back-End Vincent, All Rights Reserved </p>
</div>
</body>
</html>